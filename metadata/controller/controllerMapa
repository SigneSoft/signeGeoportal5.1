{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "controllerMapa",
        "views": [
            "LegendPanel"
        ]
    },
    "name": "MyController",
    "designerId": "57b5bd24-aacb-4e2b-b591-bcf482d529b8",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#btnEnfocar",
                "designer|params": [
                    "button",
                    "e",
                    "eOpts"
                ],
                "designer|targetType": "Ext.button.Button",
                "fn": "onBtnEnfocarClick",
                "implHandler": [
                    "signeGeoportal.xMap.map.zoomToScale(2000000,false);",
                    "",
                    "//signePortal.xMap.zoomToExtent(new OpenLayers.Bounds(minLng,minLat,maxLng,maxLat));"
                ],
                "name": "click"
            },
            "name": "onBtnEnfocarClick",
            "designerId": "f6bd9f62-343b-4527-8cf1-f2e3728865e0"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#btnEliminarCapa",
                "designer|params": [
                    "button",
                    "e",
                    "eOpts"
                ],
                "designer|targetType": "Ext.button.Button",
                "fn": "onBtnEliminarCapaClick",
                "implHandler": [
                    "var layer = signeGeoportal.getApplication().obtenerLayer();",
                    "",
                    "if (layer){",
                    "    Ext.MessageBox.show({",
                    "        title : 'Eliminar Capa',",
                    "        buttons : Ext.MessageBox.YESNO,",
                    "        msg : 'Realmente desea eliminar la capa ' + record.data.layer.name +  ' del mapa ?',",
                    "        icon : Ext.Msg.WARNING,",
                    "        fn : function(btn)",
                    "        {",
                    "            if (btn == 'yes')",
                    "            {",
                    "                signeGeoportal.xMap.map.removeLayer(layer);",
                    "            }",
                    "",
                    "        }",
                    "    });",
                    "}",
                    "",
                    "",
                    ""
                ],
                "name": "click"
            },
            "name": "onBtnEliminarCapaClick",
            "designerId": "c0698dc8-8eeb-4965-a752-0c1242a76e25"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#btnImprimir",
                "designer|params": [
                    "button",
                    "e",
                    "eOpts"
                ],
                "designer|targetType": "Ext.button.Button",
                "fn": "onBtnImprimirClick",
                "implHandler": [
                    "/*** Funcional ****/",
                    "/*printDialog = Ext.create('Ext.Window', {",
                    "    title: \"Vista previa de impresión\",",
                    "    layout: \"fit\",",
                    "    border: false,",
                    "    width: 500,",
                    "    modal: true,",
                    "    heigth: 200,",
                    "    // autoHeight: true,",
                    "    items: [{",
                    "        xtype: 'textfield',",
                    "        fieldLabel: 'Titulo',",
                    "        id: 'txtTitulo',",
                    "        width: 200,",
                    "        height: 10,",
                    "        //  anchor: '90%',",
                    "    },{",
                    "        xtype: \"gx_printmappanel\",",
                    "        sourceMap: signeGeoportal.xMap,",
                    "        printProvider: printProvider,",
                    "    },",
                    "            {",
                    "                xtype: 'textarea',",
                    "                fieldLabel: 'Comentario',",
                    "                id: 'txtComentario',",
                    "                width: 100,",
                    "                //        anchor: '90%',",
                    "            }],",
                    "    tbar: [{",
                    "        text: \"Imprimir PDF\",",
                    "        handler: function(){",
                    "            printDialog.items.get(1).printProvider.customParams.mapTitle = Ext.getCmp('txtTitulo').getValue();",
                    "            printDialog.items.get(1).printProvider.customParams.comment = Ext.getCmp('txtComentario').getValue();",
                    "            printDialog.items.get(1).print();",
                    "        }",
                    "    }]",
                    "});",
                    "",
                    "printDialog.show();*/",
                    "var printExtent = Ext.create('GeoExt.plugins.PrintExtent', {",
                    "    printProvider: printProvider",
                    "});",
                    "",
                    "",
                    "",
                    "printDialog = Ext.create('Ext.Window', {",
                    "    height: 580,",
                    "    width: 450,",
                    "    layout: 'border',",
                    "    title: 'Vista previa de impresión.',",
                    "    modal: true,",
                    "    items: [",
                    "        {",
                    "            xtype: 'panel',",
                    "            region: 'north',",
                    "            layout: 'fit',",
                    "            title: '',",
                    "            dockedItems: [",
                    "                {",
                    "                    xtype: 'toolbar',",
                    "                    dock: 'top',",
                    "                    items: [",
                    "                        {",
                    "                            xtype: 'button',",
                    "                            id: 'btnImprimirMapa',",
                    "                            text: 'Imprimir PDF',",
                    "                            iconCls: 'print-pdf',",
                    "                            handler: function(){",
                    "                                var legendpanel = Ext.getCmp('legendlayer');",
                    "                                //console.log();",
                    "",
                    "",
                    "                                var includeLegend;",
                    "                                includeLegend = true;",
                    "                                printPage.scale = 100000;",
                    "                                printPage.fit(signeGeoportal.xMap, true);",
                    "",
                    "                                printDialog.items.get(1).items.get(0).printProvider.customParams.mapTitle = Ext.getCmp('txtTitulo').getValue();",
                    "                                printDialog.items.get(1).items.get(0).printProvider.customParams.comment = Ext.getCmp('txtComentario').getValue();",
                    "                                printDialog.items.get(1).items.get(0).print(signeGeoportal.xMap, printPage, includeLegend && {legend: legendpanel});",
                    "",
                    "                                // convenient way to fit the print page to the visible map area",
                    "                                //printPage.fit(mapPanel, true);",
                    "                                // print the page, optionally including the legend",
                    "                                printProvider.print(signeGeoportal.xMap, printPage, includeLegend && {legend: legendpanel});",
                    "                            }",
                    "",
                    "                        }",
                    "                    ]",
                    "                }",
                    "            ],",
                    "            items: [",
                    "                {",
                    "                    xtype: 'fieldset',",
                    "                    height: 120,",
                    "                    title: 'Información del mapa',",
                    "                    items: [",
                    "                        {",
                    "                            xtype: 'textfield',",
                    "                            anchor: '100%',",
                    "                            id: 'txtTitulo',",
                    "                            fieldLabel: 'Titulo',",
                    "                            name: 'tituloMapa',",
                    "                            allowBlank: false",
                    "                        },",
                    "                        {",
                    "                            xtype: 'textareafield',",
                    "                            anchor: '100%',",
                    "                            id: 'txtComentario',",
                    "                            fieldLabel: 'Comentario',",
                    "                            name: 'comentarioMapa',",
                    "                            allowBlank: false",
                    "                        }",
                    "                    ]",
                    "                }",
                    "            ]",
                    "        },",
                    "        {",
                    "            xtype: 'panel',",
                    "            items: {",
                    "                xtype: \"gx_printmappanel\",",
                    "                sourceMap: signeGeoportal.xMap,",
                    "                printProvider: printProvider,",
                    "                zoom:20,",
                    "                center: new OpenLayers.LonLat(-10048800, 1735400),",
                    "                //limitScales:true,",
                    "                //plugins: [printExtent],",
                    "            },",
                    "            region: 'center',",
                    "            layout: 'fit',",
                    "        }]",
                    "});",
                    "",
                    "",
                    "printDialog.show();",
                    "",
                    "//printExtent.addPage();",
                    ""
                ],
                "name": "click"
            },
            "name": "onBtnImprimirClick",
            "designerId": "e0c461fd-c825-4b3f-be06-62b84c273af4"
        }
    ]
}